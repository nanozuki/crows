#!/usr/bin/env fish
source ~/.local/share/chezmoi/utils.fish

### package mangager
#{{if eq .chezmoi.os "darwin"}}
brew update && brew upgrade && brew cleanup
#{{else}}
paru -Syu --noconfirm
sudo flatpak upgrade
#{{end}}

### terminals
fisher update
#{{if eq .chezmoi.os "darwin"}}
brew upgrade --cask wezterm-nightly --no-quarantine --greedy-latest
#{{end}}

### languages
# golang
go install github.com/davidrjenni/reftools/cmd/fillstruct@latest
go install golang.org/x/tools/cmd/goimports@latest
go install github.com/fatih/gomodifytags@latest
go install github.com/segmentio/golines@latest
go install github.com/cweill/gotests/...@latest

go install github.com/google/wire/cmd/wire@latest
go install github.com/go-swagger/go-swagger/cmd/swagger@latest
go install github.com/nametake/golangci-lint-langserver@latest

go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
go install github.com/golang/protobuf/{proto,protoc-gen-go}@latest

# rust
rustup update

# lua
cargo install stylua

# zig
#{{if eq .chezmoi.os "darwin"}}
brew reinstall zig
macos_sync_zls
#{{end}}

### neovim
#{{if eq .chezmoi.os "darwin" }}
pip3 install -U pynvim
npm -g update neovim
npm -g install neovim
npm -g install graphql-language-service-cli
npm -g install vim-language-server
#{{else}}
sudo npm -g update neovim
sudo npm -g install neovim
sudo npm -g install graphql-language-service-cli
sudo npm -g install vim-language-server
#{{end}}

### rime
#{{if eq .chezmoi.os "linux"}}
set -lx rime_frontend fcitx5-rime
#{{end}}
sync_rime_schema
