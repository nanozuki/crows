local wezterm = require('wezterm')

local keys = {
  -- fix issue: press <S-Del> will input text '<S-Del>' in vim
  { key = 'Delete', mods = 'SHIFT', action = { SendKey = { key = 'Delete' } } },
  -- split vertical
  { key = '|', mods = 'LEADER', action = wezterm.action({ SplitHorizontal = { domain = 'CurrentPaneDomain' } }) },
  -- split horizontal
  { key = '%', mods = 'LEADER', action = wezterm.action({ SplitVertical = { domain = 'CurrentPaneDomain' } }) },
  -- nav between panels
  { key = 'h', mods = 'LEADER', action = wezterm.action({ ActivatePaneDirection = 'Left' }) },
  { key = 'j', mods = 'LEADER', action = wezterm.action({ ActivatePaneDirection = 'Down' }) },
  { key = 'k', mods = 'LEADER', action = wezterm.action({ ActivatePaneDirection = 'Up' }) },
  { key = 'l', mods = 'LEADER', action = wezterm.action({ ActivatePaneDirection = 'Right' }) },
  -- new tab
  { key = 'c', mods = 'LEADER', action = wezterm.action({ SpawnTab = 'DefaultDomain' }) },
  { key = 'C', mods = 'LEADER|SHIFT', action = wezterm.action({ SpawnTab = 'DefaultDomain' }) },
  -- close current tab
  { key = 'x', mods = 'LEADER', action = wezterm.action({ CloseCurrentTab = { confirm = true } }) },
}
for i = 1, 9, 1 do
  table.insert(keys, {
    key = string.format('%d', i),
    mods = 'LEADER',
    action = wezterm.action({ ActivateTab = i - 1 }),
  })
end

return {
  -- keymapping
  leader = { key = 'j', mods = 'CTRL', timeout_milliseconds = 1000 },
  keys = keys,
  -- text config
  font = wezterm.font_with_fallback({
    'JetBrainsMono Nerd Font',
    'Menlo',
    'Apple Braille',
    'Geneva',
    'Apple Color Emoji',
    'PingFang SC',
  }),
  font_size = {{ default "10" .term.font_size }},
  -- appearance/color
  color_scheme = 'rose-pine-dawn',
  colors = require('lua/rose-pine-dawn').colors(),
  -- appearance/tab
  enable_tab_bar = true,
  use_fancy_tab_bar = false,
  tab_max_width = 99,
  -- appearance/window
  window_frame = require('lua/rose-pine-dawn').window_frame(),
  window_padding = { left = 2, right = 2, top = 0, bottom = 0 },
  -- misc
  use_ime = true,
  enable_wayland = true,
}
